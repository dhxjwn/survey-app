<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <title>Admin</title>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Arial; padding: 24px; }
    table { border-collapse: collapse; width: 100%; margin-top: 12px; }
    th, td { border: 1px solid #ddd; padding: 8px; font-size: 14px; }
    th { background: #f6f6f6; text-align: left; }
    .card { border: 1px solid #eee; padding: 12px; border-radius: 10px; margin: 12px 0; }
    .muted { color: #666; }
  </style>
</head>
<body>
  <h2>後台</h2>
  <p class="muted">需要帳密（瀏覽器會跳出登入框）。</p>

  <div class="card">
    <div><b>總筆數：</b>{{ total }}</div>
  </div>

  <div class="card">
    <h2>Department 統計</h2>
{% if dept_stats and dept_stats|length > 0 %}
<table border="1" cellpadding="6">
  <tr><th>Department</th><th>Count</th></tr>
  {% for x in dept_stats %}
  <tr><td>{{ x.department }}</td><td>{{ x.count }}</td></tr>
  {% endfor %}
</table>
{% else %}
<p>目前沒有資料</p>
{% endif %}
  </div>

  <div class="card">
<h2>最近 20 筆</h2>
{% if rows and rows|length > 0 %}
<table border="1" cellpadding="6">
  <tr>
    <th>ID</th><th>Name</th><th>Department</th><th>Age</th>
    <th>Q1</th><th>Q2</th><th>Q3</th><th>Q4</th><th>Q5</th><th>Q6</th><th>Q7</th>
    <th>Time</th>
  </tr>
  {% for r in rows %}
  <tr>
    <td>{{ r.id }}</td>
    <td>{{ r.name }}</td>
    <td>{{ r.department }}</td>
    <td>{{ r.age }}</td>
    <td>{{ r.q1_future_state }}</td>
    <td>{{ r.q2_emotion_impact }}</td>
    <td>{{ r.q3_obstacles }}</td>
    <td>{{ r.q4_solution }}</td>
    <td>{{ r.q5_help_channel }}</td>
    <td>{{ r.q6_avoid }}</td>
    <td>{{ r.q7_prefer }}</td>
    <td>{{ r.time }}</td>
  </tr>
  {% endfor %}
</table>
{% else %}
<p>目前沒有資料</p>
{% endif %}
  </div>
</body>
</html>